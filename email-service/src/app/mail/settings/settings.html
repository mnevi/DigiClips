<div class="settings-container">
  <!-- Header -->
  <header class="settings-header">
    <div class="header-left">
      <button class="back-btn" (click)="goBack()" title="Go back">‚Üê</button>
      <h1>‚öôÔ∏è Settings</h1>
    </div>
    @if (saveSuccess()) {
      <div class="success-message">‚úì Settings saved</div>
    }
  </header>

  <div class="settings-content" *ngIf="preferences() as prefs">
    <!-- Tabs -->
    <div class="settings-tabs">
      <button
        class="tab-btn"
        [class.active]="activeTab() === 'general'"
        (click)="selectTab('general')"
      >
        General
      </button>
      <button
        class="tab-btn"
        [class.active]="activeTab() === 'appearance'"
        (click)="selectTab('appearance')"
      >
        Appearance
      </button>
      <button
        class="tab-btn"
        [class.active]="activeTab() === 'notifications'"
        (click)="selectTab('notifications')"
      >
        Notifications
      </button>
      <button
        class="tab-btn"
        [class.active]="activeTab() === 'signature'"
        (click)="selectTab('signature')"
      >
        Signature
      </button>
    </div>

    <!-- Tab Content -->
    <div class="settings-panel">
      <!-- General Settings -->
      @if (activeTab() === 'general') {
        <div class="settings-section">
          <h2>General Settings</h2>

          <div class="setting-item">
            <label class="setting-label">
              <span>Emails per page</span>
              <input
                type="number"
                min="5"
                max="100"
                [(ngModel)]="prefs.emailsPerPage"
                class="input-number"
              />
            </label>
          </div>

          <div class="setting-item">
            <label class="setting-label">
              <span>Default reply format</span>
              <select [(ngModel)]="prefs.defaultReplyFormat" class="input-select">
                <option value="plain">Plain text</option>
                <option value="html">HTML</option>
              </select>
            </label>
          </div>

          <div class="setting-item">
            <label class="setting-checkbox">
              <input
                type="checkbox"
                [checked]="prefs.showPreview"
                [(ngModel)]="prefs.showPreview"
              />
              <span>Show email preview in inbox</span>
            </label>
          </div>

          <div class="setting-item">
            <label class="setting-checkbox">
              <input
                type="checkbox"
                [checked]="prefs.compactView"
                [(ngModel)]="prefs.compactView"
              />
              <span>Use compact view</span>
            </label>
          </div>
        </div>
      }

      <!-- Appearance Settings -->
      @if (activeTab() === 'appearance') {
        <div class="settings-section">
          <h2>Appearance</h2>

          <div class="setting-item">
            <label class="setting-label">
              <span>Theme</span>
              <select [(ngModel)]="prefs.theme" class="input-select">
                <option value="light">Light mode</option>
                <option value="dark">Dark mode</option>
              </select>
            </label>
          </div>

          <div class="theme-preview">
            <p class="preview-text">Theme preview will be applied when you save.</p>
          </div>
        </div>
      }

      <!-- Notification Settings -->
      @if (activeTab() === 'notifications') {
        <div class="settings-section">
          <h2>Notifications</h2>

          <div class="setting-item">
            <label class="setting-checkbox">
              <input
                type="checkbox"
                [checked]="prefs.notificationsEnabled"
                (change)="toggleNotifications($event)"
              />
              <span>Enable notifications</span>
            </label>
          </div>

          <div class="setting-item">
            <label class="setting-checkbox">
              <input type="checkbox" />
              <span>Sound notification</span>
            </label>
          </div>

          <div class="setting-item">
            <label class="setting-checkbox">
              <input type="checkbox" />
              <span>Desktop notifications</span>
            </label>
          </div>

          <div class="setting-item">
            <label class="setting-checkbox">
              <input
                type="checkbox"
                [checked]="prefs.autoSaveDraft"
                (change)="toggleAutoSave($event)"
              />
              <span>Auto-save drafts</span>
            </label>
          </div>

          @if (prefs.autoSaveDraft) {
            <div class="setting-item indented">
              <label class="setting-label">
                <span>Auto-save interval (seconds)</span>
                <input
                  type="number"
                  min="10"
                  max="300"
                  [(ngModel)]="prefs.autoSaveInterval"
                  class="input-number"
                />
              </label>
            </div>
          }
        </div>
      }

      <!-- Signature Settings -->
      @if (activeTab() === 'signature') {
        <div class="settings-section">
          <h2>Email Signature</h2>

          <div class="setting-item">
            <label class="setting-label full-width">
              <span>Signature</span>
              <textarea
                [(ngModel)]="prefs.signature"
                rows="6"
                placeholder="Add your email signature..."
                class="input-textarea"
              ></textarea>
            </label>
            <small class="help-text">This signature will be automatically added to emails you send.</small>
          </div>

          <div class="signature-preview">
            <h3>Preview:</h3>
            <div class="preview-content">
              {{ prefs.signature }}
            </div>
          </div>
        </div>
      }

      <!-- Action Buttons -->
      <div class="settings-actions">
        <button class="btn-primary" (click)="savePreferences()">
          üíæ Save Changes
        </button>
        <button class="btn-secondary" (click)="resetPreferences()">
          Reset
        </button>
      </div>
    </div>
  </div>
</div>
